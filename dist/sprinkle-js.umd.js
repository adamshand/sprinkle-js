(function(d,b){typeof exports=="object"&&typeof module<"u"?b(exports):typeof define=="function"&&define.amd?define(["exports"],b):(d=typeof globalThis<"u"?globalThis:d||self,b(d.SprinkleJS={}))})(this,function(d){"use strict";const b=e=>typeof e=="string"?document.querySelector(e):e,C=(e,t,n=[])=>{Object.entries(t).forEach(([l,o])=>{if(typeof o=="object"){C(e,o,[...n,l]);return}let c=e;if(n.forEach(i=>{c=c[i]}),n[n.length-1]==="style"&&l.startsWith("--")){c.setProperty(l,o);return}if(l==="className"&&e instanceof SVGElement){c.setAttribute("class",o.toString());return}if(n.length===0&&l.startsWith("data-")){e.setAttribute(l,o);return}c[l]=o})},M=(e,t)=>[...Array(e).keys()].map(()=>Array(t).fill(0)),I=(e=[],t=[],n=(s,l)=>s===l)=>{var i,u,h,y,f,a;const s=M(e.length+1,t.length+1);for(let r=0;r<e.length+1;r+=1)s[r][0]=r;for(let r=0;r<t.length+1;r+=1)s[0][r]=r;for(let r=0;r<e.length;r+=1)for(let E=0;E<t.length;E+=1)if(n(e[r],t[E]))s[r+1][E+1]=s[r][E];else{const $=Math.min(s[r+1][E],s[r][E+1])+1;s[r+1][E+1]=$}const l=[];let o=e.length,c=t.length;for(;o>0&&c>0;)n(e[o-1],t[c-1])?(l.unshift({type:"=",value:e[o-1],skip:!1}),c-=1,o-=1):s[o-1][c]<s[o][c-1]?(l.unshift({type:"-",value:e[o-1],skip:!1}),o-=1):(l.unshift({type:"+",value:t[c-1],skip:!1}),c-=1);return o>0?l.unshift(...((h=(u=(i=e==null?void 0:e.slice)==null?void 0:i.call(e,0,o))==null?void 0:u.map)==null?void 0:h.call(u,r=>({type:"-",value:r,skip:!1})))||[]):c>0&&l.unshift(...((a=(f=(y=t==null?void 0:t.slice)==null?void 0:y.call(t,0,c))==null?void 0:f.map)==null?void 0:a.call(f,r=>({type:"+",value:r,skip:!1})))||[]),l},S=(e,t,n=0)=>e.find((s,l,...o)=>l>n&&t(s,l,...o)),R=e=>Object.prototype.toString.call(e).slice(8,-1),V=e=>{const t=document.createElement("template");return Object.assign(t,{innerHTML:e}),t.content},P=(e,t)=>e.getAttribute(t),m=e=>e instanceof Element?P(e,"key"):e.textContent;let p=[];const j=Symbol("is-reactive");let g=null;const A=e=>{[...e].forEach(t=>{if(!t.toRun)return;const n=t.execute();n&&(t.cleanup=n)})},x=e=>{g=new Set;try{e()}finally{const t=new Set(g);g=null,A(t)}},v=(e,t,n)=>{let s=n.get(e);s||(s=new Set,n.set(e,s)),s.add(t),t.dependencies.add(s)},O=(e,t)=>{const n=e.get(t);if(!!n){if(g!==null){n.forEach(s=>g.add(s));return}A(n)}},k=(e,t)=>{if(e[j])return e;if(typeof e!="object")throw new Error("It's not possible to create a variable from a primitive value...you can use createRef");Object.keys(e||{}).forEach(o=>{const c=o;!!e[c]&&typeof e[c]=="object"&&(R(e[c])==="Object"||Array.isArray(e[c]))&&(e[c]=k(e[c],t==null?void 0:t[c]))});const s=new Map;return new Proxy(e,{get:(...o)=>{if(o[1]===j)return!0;const c=p[p.length-1];return c&&v(o[1],c,s),Reflect.get(...o)},set:(o,c,i)=>{var r;const u=c,h=(r=t==null?void 0:t[u])!=null?r:Object.is;let y=i;!!i&&typeof i=="object"&&(R(i)==="Object"||Array.isArray(i))&&!i[j]&&(y=k(i,h));const f=h(o[u],i),a=Reflect.set(o,c,y);return f||O(s,c),a}})},N=(e,t,n=":root")=>{const s=k(e,t);let l=b(n);return l||(console.warn("Impossible to find the right html element, attaching the variables to the root."),l=document.querySelector(":root")),w(()=>{Object.keys(s).forEach(c=>{var i;l.style.setProperty(`--${c}`,(i=s[c])==null?void 0:i.toString())})}),s},J=(e,t)=>{const n={value:e()};let s=!1;const l=new Map,o=new Proxy(n,{get:(...c)=>{const i=p[p.length-1];return i&&v(c[1],i,l),Reflect.get(...c)},set:(c,i,u)=>{if(!s)return!0;const h=i,f=(t!=null?t:Object.is)(c[h],u),a=Reflect.set(c,i,u);return f||O(l,i),a}});return w(()=>{s=!0,o.value=e(),s=!1}),o},_=(e,t,n,s=window.localStorage)=>{if(typeof t!="object")throw new Error("It's not possible to create a variable from a primitive value...you can use createRef");const l=new Map;let o=null;try{const i=s.getItem(e);i?o=JSON.parse(i):s.setItem(e,JSON.stringify(t))}catch{throw new Error("The specified key is associated with a non Object-like element")}const c=new Proxy(o!=null?o:t,{get:(...i)=>{const u=p[p.length-1];return u&&v(i[1],u,l),Reflect.get(...i)},set:(i,u,h)=>{var E;const y=u,a=((E=n==null?void 0:n[y])!=null?E:Object.is)(i[y],h),r=Reflect.set(i,u,h);return s.setItem(e,JSON.stringify(i)),a||O(l,u),r}});return window.addEventListener("storage",i=>{if(i.storageArea===s&&i.key===e)try{if(i.newValue){const u=JSON.parse(i.newValue);Object.keys(u).forEach(y=>{c[y]=u[y]})}}catch{console.warn("The storage was modified but the resulting object is not parsable...the variable was not updated.")}}),c},H=(e,t)=>k({value:e},t?{value:t}:void 0),T=e=>{e.owned.forEach(t=>{t.toRun=!1,T(t)}),e.dependencies.forEach(t=>{t.delete(e)}),e.dependencies.clear()},w=e=>{const t=()=>{var o,c,i;if(!n.toRun)return;(i=(c=(o=n==null?void 0:n.owner)==null?void 0:o.owned)==null?void 0:c.push)==null||i.call(c,n),n.cleanup&&typeof n.cleanup=="function"&&n.cleanup(),T(n),p.push(n);let l;try{l=e()}finally{p.pop()}return l},n={execute:t,dependencies:new Set,owned:[],owner:p[p.length-1],toRun:!0},s=t();s&&(n.cleanup=s)},U=e=>{const t=p;p=[];const n=e();return p=t,n},W=(e,t)=>{const n=b(e);return w(()=>{n&&(n.textContent=t(n))}),n},F=(e,t)=>{const n=b(e);return w(()=>{n&&(n.innerHTML=t(n))}),n},B=(e,t,n)=>{const s=b(e);return w(()=>{s&&(n(s)?s.classList.add(t):s.classList.remove(t))}),s},D=(e,t)=>{const n=b(e);return w(()=>{if(n){const s=t(n);Object.keys(s||{}).forEach(o=>{s[o]?n.classList.add(o):n.classList.remove(o)})}}),n},G=(e,t)=>{const n=b(e);return w(()=>{n&&(n.value=t(n))}),n},L=(e,t)=>{const n=b(e);return w(()=>C(n,t(n))),n},Q=(e,t)=>{const n=b(e);if(!!n)return L(n,()=>({style:t(n)})),n},Y=(e,t,n)=>{const s=b(e);return w(()=>{if(s===null)return;const l=t(s),o=V(l).childNodes,c=new Map,i=(f,a=!0)=>{const r=m(f);r!=null&&c.set(r,{element:f,isNew:a})};if(s.children.length===0){const f=Array.from(o);s.append(...f),f.forEach(a=>i(a)),typeof n=="function"&&w(()=>{n(s,c)});return}const u=I(Array.from(s.childNodes),Array.from(o),(f,a)=>m(f)!=null&&m(a)!=null?m(f)===m(a):f===a);let h=u.find(f=>f.type==="="),y=0;u.forEach(f=>{if(f.type==="+"){const a=S(u,r=>r.type==="-"&&m(r.value)===m(f.value),y);if(a&&(f.value=a.value,a.skip=!0),!h){s.append(f.value),i(f.value),y+=1;return}h.value.before(f.value),i(f.value)}else if(f.type==="-"){if(f.skip){y+=1;return}s.removeChild(f.value);const a=S(u,r=>r.type==="+"&&m(r.value)===m(f.value),y);a&&(a.value=f.value)}else h=S(u,a=>a.type==="=",y),i(f.value,!1);y+=1}),typeof n=="function"&&w(()=>{n(s,c)})}),s};d.batch=x,d.bindChildrens=Y,d.bindClass=B,d.bindClasses=D,d.bindDom=L,d.bindInnerHTML=F,d.bindInputValue=G,d.bindStyle=Q,d.bindTextContent=W,d.createComputed=J,d.createCssVariable=N,d.createEffect=w,d.createRef=H,d.createStored=_,d.createVariable=k,d.untrack=U,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
