(function(d,b){typeof exports=="object"&&typeof module<"u"?b(exports):typeof define=="function"&&define.amd?define(["exports"],b):(d=typeof globalThis<"u"?globalThis:d||self,b(d.SprinkleJS={}))})(this,function(d){"use strict";const b=e=>typeof e=="string"?document.querySelector(e):e,C=(e,t,n=[])=>{const s=Object.entries(t);for(let[f,i]of s){if(typeof i=="object"){C(e,i,[...n,f]);return}let o=e;for(const c of n)o=o[c];n[n.length-1]==="style"&&o.setProperty(f,i),o[f]=i}},I=(e,t)=>[...Array(e).keys()].map(()=>Array(t).fill(0)),L=(e=[],t=[],n=(s,f)=>s===f)=>{var c,u,y,p,r,a;const s=I(e.length+1,t.length+1);for(let l=0;l<e.length+1;l++)s[l][0]=l;for(let l=0;l<t.length+1;l++)s[0][l]=l;for(let l=0;l<e.length;l++)for(let w=0;w<t.length;w++)if(n(e[l],t[w]))s[l+1][w+1]=s[l][w];else{const $=Math.min(s[l+1][w],s[l][w+1])+1;s[l+1][w+1]=$}const f=[];let i=e.length,o=t.length;for(;i>0&&o>0;)n(e[i-1],t[o-1])?(f.unshift({type:"=",value:e[i-1],skip:!1}),o--,i--):s[i-1][o]<s[i][o-1]?(f.unshift({type:"-",value:e[i-1],skip:!1}),i--):(f.unshift({type:"+",value:t[o-1],skip:!1}),o--);return i>0?f.unshift(...((y=(u=(c=e==null?void 0:e.slice)==null?void 0:c.call(e,0,i))==null?void 0:u.map)==null?void 0:y.call(u,l=>({type:"-",value:l,skip:!1})))||[]):o>0&&f.unshift(...((a=(r=(p=t==null?void 0:t.slice)==null?void 0:p.call(t,0,o))==null?void 0:r.map)==null?void 0:a.call(r,l=>({type:"+",value:l,skip:!1})))||[]),f},S=(e,t,n=0)=>e.find((s,f,...i)=>f>n&&t(s,f,...i)),R=e=>Object.prototype.toString.call(e).slice(8,-1),V=e=>{const t=document.createElement("template");return Object.assign(t,{innerHTML:e}),t.content},P=(e,t)=>e.getAttribute(t),g=e=>e instanceof Element?P(e,"key"):e.textContent;let h=[];const k=Symbol("is-reactive");let v=null;const N=e=>{v=new Set;try{e()}finally{const t=new Set(v);v=null,T(t)}},j=(e,t,n)=>{let s=n.get(e);s||(s=new Set,n.set(e,s)),s.add(t),t.dependencies.add(s)},T=e=>{[...e].forEach(t=>{if(!t.toRun)return;const n=t.execute();n&&(t.cleanup=n)})},O=(e,t)=>{const n=e.get(t);if(!!n){if(v!==null){n.forEach(s=>v.add(s));return}T(n)}},E=(e,t)=>{if(e[k])return e;if(typeof e!="object")throw new Error("It's not possible to create a variable from a primitive value...you can use createRef");const n=Object.keys(e||{});for(let i of n){const o=i;!!e[o]&&typeof e[o]=="object"&&(R(e[o])==="Object"||Array.isArray(e[o]))&&(e[o]=E(e[o],t==null?void 0:t[o]))}const s=new Map;return new Proxy(e,{get:(...i)=>{if(i[1]===k)return!0;const o=h[h.length-1];return o&&j(i[1],o,s),Reflect.get(...i)},set:(i,o,c)=>{var l;const u=o,y=(l=t==null?void 0:t[u])!=null?l:Object.is;let p=c;!!c&&typeof c=="object"&&(R(c)==="Object"||Array.isArray(c))&&!c[k]&&(p=E(c,y));const r=y(i[u],c),a=Reflect.set(i,o,p);return r||O(s,o),a}})},x=(e,t,n=":root")=>{const s=E(e,t);let f=b(n);return f||(console.warn("Impossible to find the right html element, attaching the variables to the root."),f=document.querySelector(":root")),m(()=>{Object.keys(s).forEach(o=>{var c;f.style.setProperty(`--${o}`,(c=s[o])==null?void 0:c.toString())})}),s},J=(e,t)=>{const n={value:e()};let s=!1;const f=new Map,i=new Proxy(n,{get:(...o)=>{const c=h[h.length-1];return c&&j(o[1],c,f),Reflect.get(...o)},set:(o,c,u)=>{if(!s)return!0;const y=c,r=(t!=null?t:Object.is)(o[y],u),a=Reflect.set(o,c,u);return r||O(f,c),a}});return m(()=>{s=!0,i.value=e(),s=!1}),i},_=(e,t,n,s=window.localStorage)=>{if(typeof t!="object")throw new Error("It's not possible to create a variable from a primitive value...you can use createRef");const f=new Map;let i=null;try{const c=s.getItem(e);c?i=JSON.parse(c):s.setItem(e,JSON.stringify(t))}catch{throw new Error("The specified key is associated with a non Object-like element")}const o=new Proxy(i!=null?i:t,{get:(...c)=>{const u=h[h.length-1];return u&&j(c[1],u,f),Reflect.get(...c)},set:(c,u,y)=>{var w;const p=u,a=((w=n==null?void 0:n[p])!=null?w:Object.is)(c[p],y),l=Reflect.set(c,u,y);return s.setItem(e,JSON.stringify(c)),a||O(f,u),l}});return window.addEventListener("storage",c=>{if(c.storageArea===s&&c.key===e)try{if(c.newValue){const u=JSON.parse(c.newValue);for(let y in u)o[y]=u[y]}}catch{console.warn("The storage was modified but the resulting object is not parsable...the variable was not updated.")}}),o},H=(e,t)=>E({value:e},t?{value:t}:void 0),A=e=>{e.owned.forEach(t=>{t.toRun=!1,A(t)});for(const t of e.dependencies)t.delete(e);e.dependencies.clear()},m=e=>{const t=()=>{var i,o,c;if(!n.toRun)return;(c=(o=(i=n==null?void 0:n.owner)==null?void 0:i.owned)==null?void 0:o.push)==null||c.call(o,n),n.cleanup&&typeof n.cleanup=="function"&&n.cleanup(),A(n),h.push(n);let f;try{f=e()}finally{h.pop()}return f},n={execute:t,dependencies:new Set,owned:[],owner:h[h.length-1],toRun:!0},s=t();s&&(n.cleanup=s)},U=e=>{const t=h;h=[];const n=e();return h=t,n},F=(e,t)=>{const n=b(e);return m(()=>{n&&(n.textContent=t(n))}),n},B=(e,t)=>{const n=b(e);return m(()=>{n&&(n.innerHTML=t(n))}),n},D=(e,t,n)=>{const s=b(e);return m(()=>{s&&(n(s)?s.classList.add(t):s.classList.remove(t))}),s},K=(e,t)=>{const n=b(e);return m(()=>{if(n){const s=t(n),f=Object.keys(s||{});for(let i of f)s[i]?n.classList.add(i):n.classList.remove(i)}}),n},Q=(e,t)=>{const n=b(e);return m(()=>{n&&(n.value=t(n))}),n},M=(e,t)=>{const n=b(e);return m(()=>C(n,t(n))),n},W=(e,t)=>{const n=b(e);if(!!n)return M(n,()=>({style:t(n)})),n},Y=(e,t,n)=>{const s=b(e);return m(()=>{if(s===null)return;const f=t(s),i=V(f).childNodes,o=new Map,c=(r,a=!0)=>{const l=g(r);(l!==null||l!=null)&&o.set(l,{element:r,isNew:a})};if(s.children.length===0){const r=Array.from(i);s.append(...r),r.forEach(a=>c(a)),typeof n=="function"&&m(()=>{n(s,o)});return}const u=L(Array.from(s.childNodes),Array.from(i),(r,a)=>g(r)!=null&&g(a)!=null?g(r)===g(a):r===a);let y=u.find(r=>r.type==="="),p=0;for(let r of u){if(r.type==="+"){const a=S(u,l=>l.type==="-"&&g(l.value)===g(r.value),p);if(a&&(r.value=a.value,a.skip=!0),!y){s.append(r.value),c(r.value),p++;continue}y.value.before(r.value),c(r.value)}else if(r.type==="-"){if(r.skip){p++;continue}s.removeChild(r.value);const a=S(u,l=>l.type==="+"&&g(l.value)===g(r.value),p);a&&(a.value=r.value)}else y=S(u,a=>a.type==="=",p),c(r.value,!1);p++}typeof n=="function"&&m(()=>{n(s,o)})}),s};d.batch=N,d.bindChildrens=Y,d.bindClass=D,d.bindClasses=K,d.bindDom=M,d.bindInnerHTML=B,d.bindInputValue=Q,d.bindStyle=W,d.bindTextContent=F,d.createComputed=J,d.createCssVariable=x,d.createEffect=m,d.createRef=H,d.createStored=_,d.createVariable=E,d.untrack=U,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
